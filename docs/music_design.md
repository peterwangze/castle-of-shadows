# 音乐与音效设计文档

## 总体音频风格

### 音乐风格
- **主风格**：8-bit/芯片音乐，致敬经典恶魔城系列
- **乐器限制**：模拟4通道芯片（2方波，1三角波，1噪声）
- **节奏**：中等偏快，强调节奏感和旋律记忆性
- **情绪**：哥特式黑暗幻想，兼具史诗感和孤独感

### 技术规格
- **格式**：OGG Vorbis（音乐），WAV（音效）
- **采样率**：44100 Hz
- **位深**：16-bit
- **文件大小**：BGM平均2-3MB，音效10-100KB

## 背景音乐设计

### 主题曲：暗影的召唤
- **使用场景**：主菜单，游戏开场
- **结构**：ABA'形式，3分钟长度
- **A段**（0:00-1:00）：阴郁的引子，管风琴音色
- **B段**（1:00-2:00）：激昂的主旋律，弦乐和铜管
- **A'段**（2:00-3:00）：变奏再现，加入合唱效果
- **乐器**：模拟管风琴、弦乐、铜管、合唱团
- **BPM**：90

### 区域BGM

#### 1. 城堡外围 - "迷雾笼罩之路"
- **情绪**：神秘，未知，略带不安
- **乐器**：主旋律（方波1），和弦（三角波），节奏（噪声通道）
- **特征**：缓慢的琶音，稀疏的打击乐
- **动态变化**：玩家接近敌人时节奏加快
- **BPM**：70→100（动态）

#### 2. 主大厅 - "沉寂的荣耀"
- **情绪**：空旷，庄严，历史沉重感
- **乐器**：模仿管风琴和钟声
- **结构**：循环的8小节旋律，逐渐加入对位声部
- **互动**：玩家发现秘密时短暂变调
- **BPM**：80

#### 3. 地下墓穴 - "亡者的低语"
- **情绪**：恐怖，压抑，幽闭
- **乐器**：低沉三角波，噪声通道模拟风声
- **特征**：不和谐音程，随机出现的恐怖音效
- **空间感**：加入混响和延迟效果
- **BPM**：60

#### 4. 宴会厅 - "血色华尔兹"
- **情绪**：优雅但扭曲，狂欢中的诡异
- **节奏**：3/4拍华尔兹，但节奏故意不稳
- **乐器**：模拟小提琴、大提琴、钢琴
- **变化**：随着玩家进展逐渐崩坏，出现错音
- **BPM**：120

#### 5. 钟楼 - "时间的回响"
- **情绪**：紧迫，机械，垂直空间的压力
- **特征**：时钟滴答声作为节奏基础
- **乐器**：金属打击乐，齿轮摩擦声采样
- **动态**：随着爬升高度增加紧张度
- **BPM**：110→130（随高度增加）

#### 6. 最终区域 - "深渊边缘"
- **情绪**：史诗，绝望，最终决战
- **结构**：多阶段，随Boss战阶段变化
- **乐器**：全通道使用，最大音量
- **高潮**：最终阶段加入人声合唱采样
- **BPM**：140

### Boss战音乐

#### 通用Boss战模板
- **前奏**（0-10秒）：紧张建立
- **主循环**（10秒后）：激烈战斗旋律
- **阶段转换**：明显音效提示，音乐变调
- **危险状态**（Boss低血量）：节奏加快，旋律简化
- **胜利**（最后10秒）：解决和弦，渐弱结束

#### 腐化骑士主题 - "堕落的誓言"
- **特征**：沉重的金属打击，骑士进行曲节奏
- **乐器**：模拟军鼓、小号、沉重低音
- **阶段变化**：
  - 阶段1：常规进行曲
  - 阶段2：节奏加倍，加入失真效果
  - 阶段3：旋律破碎，不和谐音程

#### 血月女巫主题 - "猩红仪式"
- **特征**：神秘的女声旋律，魔法咏唱感
- **乐器**：模拟女声、铃铛、神秘氛围音效
- **阶段变化**：
  - 咏唱阶段：缓慢，旋律清晰
  - 仪式阶段：节奏加快，加入打击乐
  - 血月阶段：全频段饱和，混乱感

#### 德古拉主题 - "永恒的黑暗"
- **特征**：经典吸血鬼主题变奏，致敬恶魔城传统
- **乐器**：管风琴、弦乐、合唱、定音鼓
- **多阶段设计**：
  - 贵族形态：优雅的华尔兹
  - 吸血鬼形态：激烈的战斗音乐
  - 蝙蝠形态：混乱的快速旋律
  - 最终形态：史诗合唱，全音量

## 音效设计

### 玩家音效

#### 移动音效
- **脚步声**：
  - 石地：清脆的石头碰撞（2种变化）
  - 木板：空洞的回响（2种变化）
  - 地毯：沉闷的摩擦声（1种）
  - 泥土：松软的踩踏声（1种）
- **跳跃音效**：
  - 起跳：短促的发力声
  - 空中：风声（随高度变化音量）
  - 落地：轻重两种，取决于下落高度

#### 战斗音效
- **剑击**：
  - 轻击：锋利的切割声（高频）
  - 重击：沉重的撞击声（低频）
  - 命中敌人：根据敌人类型不同
    - 骷髅：骨头碎裂声
    - 怨灵：能量消散声
    - 血肉：湿润的切割声
- **受击**：
  - 轻伤：短暂的吸气声
  - 重伤：痛苦的叫声（3种变化）
  - 死亡：长时间的哀叹，渐弱

#### 能力音效
- **暗影潜行**：神秘的嗡鸣声，进入和退出不同
- **空中冲刺**：快速的风切声
- **二段跳**：第二跳有特殊音效（能量释放）

### 敌人音效

#### 通用音效
- **发现玩家**：警觉音（每种敌人不同）
- **攻击**：根据攻击方式定制
- **死亡**：独特的死亡声音，带消散效果
- **巡逻**：环境音（骷髅的骨骼声，幽灵的低语）

#### 特殊音效
- **骷髅**：骨骼摩擦声，锈剑挥舞声
- **怨灵**：空灵哀嚎，能量聚集声
- **血蝠**：高频蝙蝠叫声，翅膀扑腾声
- **石像鬼**：石头摩擦声，翅膀展开声

### 环境音效

#### 氛围音效
- **城堡外围**：风声，枯叶沙沙，远处狼嚎
- **墓穴**：滴水声，远处呻吟，锁链拖动
- **宴会厅**：微弱音乐回声，餐具碰撞
- **钟楼**：齿轮转动，钟摆摆动，风声呼啸

#### 交互音效
- **机关触发**：金属碰撞，齿轮转动
- **门打开**：沉重的木门吱呀声
- **宝箱开启**：解锁声，打开声，物品出现声
- **存档点**：蜡烛点燃声，魔法嗡鸣

#### 界面音效
- **菜单导航**：清脆的点击声（4种方向）
- **选择确认**：满意的确定声
- **取消返回**：轻微的撤回声
- **获得物品**：根据物品稀有度不同音效

### 语音片段

#### 玩家语音
- **发现秘密**："嗯？这是什么..."
- **低生命值**："呃...需要治疗"
- **使用物品**："这个应该有用"
- **击败Boss**："结束了..."

#### NPC语音
- **导师通讯**：简短有力的指令
- **德古拉嘲讽**：优雅的威胁语言
- **莉亚娜求助**：虚弱的呼救声

## 音频实现技术

### Godot音频设置
```gdscript
# 音乐播放器配置
var music_player = AudioStreamPlayer.new()
music_player.bus = "Music"
music_player.volume_db = -10  # 相对音量

# 音效播放器池（避免重叠限制）
var sfx_pool = []
for i in range(8):
    var player = AudioStreamPlayer.new()
    player.bus = "SFX"
    sfx_pool.append(player)

# 动态混音
func set_mood(mood):
    match mood:
        "exploration":
            AudioServer.set_bus_volume_db(1, -5)  # 音乐音量
            AudioServer.set_bus_volume_db(2, -10) # 环境音量
        "combat":
            AudioServer.set_bus_volume_db(1, 0)   # 音乐音量提高
            AudioServer.set_bus_volume_db(2, -20) # 环境音量降低
```

### 音频总线配置
```
Master (0)
├── Music (1)     # 背景音乐
├── SFX (2)       # 音效
├── Voice (3)     # 语音
└── Ambient (4)   # 环境音
```

### 动态音频系统
- **距离衰减**：3D音效，随距离衰减
- **遮挡计算**：墙壁遮挡降低高频
- **优先级系统**：重要音效打断次要音效
- **变调处理**：受伤时音乐降调，紧张时升调

## 创作工具与流程

### 推荐工具
1. **音乐创作**：
   - Bosca Ceoil（免费，芯片音乐友好）
   - BeepBox（在线，即时分享）
   - Famitracker（高级，精确的NES模拟）
   - LMMS（免费DAW，综合性强）

2. **音效创作**：
   - Bfxr（芯片音效生成器）
   - Chiptone（在线芯片音效）
   - Audacity（免费音频编辑）
   - SFXR（经典音效生成器）

3. **语音处理**：
   - 文本转语音（初始占位）
   - 真人录音（最终版本）
   - 效果处理（混响，失真）

### 制作流程
1. **原型阶段**：使用生成工具创建占位音效
2. **测试阶段**：在游戏中测试音频配合度
3. **迭代阶段**：根据反馈调整音效参数
4. **最终阶段**：专业工具制作高质量音频
5. **优化阶段**：压缩，流式加载优化

### 文件命名规范
```
音乐：
  bgm_area_name.ogg
  boss_bossname.ogg
  menu_theme.ogg

音效：
  sfx_player_action.ogg
  sfx_enemy_type_action.ogg
  sfx_ui_action.ogg

语音：
  voice_character_line.ogg
```

### 目录结构
```
assets/audio/
├── music/
│   ├── areas/（区域BGM）
│   ├── bosses/（Boss战音乐）
│   └── menus/（菜单音乐）
├── sfx/
│   ├── player/（玩家音效）
│   ├── enemies/（敌人音效）
│   ├── ui/（界面音效）
│   └── environment/（环境音效）
└── voice/
    ├── player/（玩家语音）
    ├── npc/（NPC语音）
    └── boss/（Boss语音）
```